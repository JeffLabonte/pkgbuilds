pkgname=pyidm
_name=pyIDM
pkgver=2020.3.22
pkgrel=1
pkgdesc="Python open source alternative to IDM (Internet Download Manager) with multi-connections"
arch=('x86_64')
url="https://github.com/pyIDM/pyIDM"
license=('GPL3')
depends=('python-pysimplegui' 'python-pyperclip' 'python-plyer' 'python-certifi' 'youtube-dl'
         'python-pycurl' 'python-pillow' 'ffmpeg')
optdepends=('xsel: clipboard access'
            'xclip: clipboard access')
#source=("$pkgname-$pkgver.tar.gz::https://github.com/$_name/$_name/archive/$pkgver.tar.gz"
source=("https://pypi.org/packages/source/${_name:0:1}/$_name/$_name-$pkgver.tar.gz"
        "$url/raw/master/icons/icon.png"
        'https://raw.githubusercontent.com/pyIDM/pyIDM/master/requirements.txt'
        "$pkgname.desktop")
sha256sums=('7dc66258965e3ff715592b68409bc2160ab5c86015be7f23f89ba1bb542c112b'
            '290f39aea9c289f1ca4cff7e0f9a6f00d5e7dd2ec693dc7b54748c94bd0c5ed5'
            'ccc29869201d4026f2814c0c577300ebbaf5adba96aa9ca06402f70f710dbe57'
            'da5d216b06a03b2aba8c7c2c750a044a05ca05f0b580da6e0fa66259843ea3cc')

prepare() {
	cp "$srcdir/requirements.txt" "$_name-$pkgver"
}

build() {
	cd "$_name-$pkgver"
	python setup.py build
}

package() {
	cd "$_name-$pkgver"
	python setup.py install --root="$pkgdir/" --optimize=1 --skip-build

	#install -Dm644 icons/icon.png "$pkgdir/usr/share/pixmaps/$pkgname.png"
	install -Dm644 "$srcdir/icon.png" "$pkgdir/usr/share/pixmaps/$pkgname.png"
	install -Dm644 "$srcdir/$pkgname.desktop" -t "$pkgdir/usr/share/applications"
}

