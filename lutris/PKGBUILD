# Maintainer: Filipe Laíns (FFY00) <lains@archlinux.org>
# Contributor: Frederik “Freso” S. Olesen <freso.dk@gmail.com>
# Contributor: Maxime Gauduin <alucryd@archlinux.org>

pkgname=lutris
pkgver=0.5.0
_buildtag=beta1
pkgrel=1
pkgdesc='Open Gaming Platform'
arch=('any')
url='https://lutris.net'
license=('GPL3')
depends=('python-gobject' 'python-yaml' 'python-evdev' 'gtk3' 'glib2' 'psmisc' 'cabextract' 'unrar' 'unzip' 'p7zip' 'curl' 'xorg-xrandr')
makedepends=('python-setuptools')
checkdepends=('xorg-server-xvfb' 'xterm' 'python-nose-cover3' 'wine')
optdepends=('wine: Run windows games'
            'wine-staging: Run windows games - Staging patches')
makedepends=('python-setuptools')
#source=("$url/releases/${pkgname}_$pkgver.tar.xz")
source=("https://github.com/$pkgname/$pkgname/archive/v$pkgver-$_buildtag.tar.gz")
sha512sums=('80718dd2db079fcbf7d8308795e35a34518511daa352223a1e8aaaf96eb9c1f7e24f64b993056209ac5529c5a3e1c5885496df59f59ae2f5cebea2bc71d348a8')

build() {
  #cd $pkgname
  cd $pkgname-$pkgver-$_buildtag

  python setup.py build
}

check() {
  #cd $pkgname
  cd $pkgname-$pkgver-$_buildtag

  xvfb-run nosetests --cover-erase --with-xunit --xunit-file=nosetests.xml --with-coverage --cover-package=lutris --cover-xml-file=coverage.xml
}

package() {
  #cd $pkgname
  cd $pkgname-$pkgver-$_buildtag

  python setup.py install --root="$pkgdir" --optimize=1 --skip-build
}
