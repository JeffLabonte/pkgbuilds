pkgname=bszenlib-git
pkgver=r127.f28098f
pkgrel=1
pkgdesc="Importers for files from the games Gothic and Gothic II for the bs:framework."
arch=('x86_64')
url="https://regoth-project.github.io/BsZenLib"
license=('GPL3')
depends=() # 'bsf' bsf-git package broken
makedepends=('git' 'cmake')
optdepends=('doxygen: for building documentation'
            'python-sphinxcontrib-plantuml: for building documentation'
            'python-breathe: for building documentation')
provides=("${pkgname%-git}")
conflicts=("${pkgname%-git}")
source=("${pkgname%-git}::git+https://github.com/REGoth-project/BsZenLib.git")
sha256sums=('SKIP')

pkgver() {
	cd "$srcdir/${pkgbase%-git}"
	printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

prepare() {
	cd "$srcdir/${pkgbase%-git}"
	mkdir build
}

build() {
	cd "$srcdir/${pkgbase%-git}/build"
#	cmake -bsf_INSTALL_DIR=path/to/bsf .. # with external bs:f installation
	cmake -DBSZENLIB_DOWNLOAD_BSF_BINARIES=On .. # let CMake download bs:f
	cmake --build . --parallel $(nproc)

	# Build docs
	#cmake --build . --target BsZenLib_docs

}

package() {
	cd "$srcdir/${pkgbase%-git}"

}
