pkgname=nodejs-fkill-cli
pkgver=5.2.0
pkgrel=1
pkgdesc="Fabulously kill processes"
arch=("i686" "x86_64")
url="https://github.com/sindresorhus/fkill-cli"
license=('MIT')
depends=('nodejs')
makedepends=('npm')
provides=('fkill-cli' 'fkill')
conflicts=('fkill-cli' 'fkill')
source=("$pkgname-$pkgver.tar.gz::https://github.com/sindresorhus/fkill-cli/archive/v$pkgver.tar.gz"
        'https://raw.githubusercontent.com/sindresorhus/fkill-cli/master/license')
noextract=("$pkgname-$pkgver.tar.gz")
sha256sums=('c79c4513a3e77719accd4f49d8d528c905fc35e7c386501a17f28dbee08f7572'
            '48da2f39e100d4085767e94966b43f4fa95ff6a0698fba57ed460914e35f94a0')

package() {
	npm install --cache "${srcdir}/npm-cache" -g --user root --prefix "$pkgdir"/usr "$pkgname-$pkgver.tar.gz"

	# Non-deterministic race in npm gives 777 permissions to random directories.
	# See https://github.com/npm/npm/issues/9359 for details.
	find "$pkgdir"/usr -type d -exec chmod 755 {} +
	
	install -Dm644 license "$pkgdir/usr/share/licenses/fkill-cli/license"
}
